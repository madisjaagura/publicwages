Import datasets
================
2021-09-24

Alustame failide sisselaadimisega

``` r
library(openxlsx)
library(tidyverse)

wd.current = "C:/Users/user/Documents/R/publicwages"
setwd(wd.current)
fnFs <- sort(list.files(path = paste0(wd.current, "/rawdata"), pattern=".xlsx", full.names = TRUE))
dates.for.files = gsub("^.*?palk_|_riik.*$|.xlsx","", fnFs)
```

Vaatame üle iga aasta andmestiku veerunimed

``` r
for(i in fnFs){
message(gsub("^.*?palk_|_riik.*$|.xlsx","", i))
wb = readWorkbook(i, colNames = TRUE, skipEmptyRows = TRUE)
colnames(wb) = wb[1,]
print(colnames(wb))
}
```

    ## 01.04.2015

    ## [1] "Asutus"                     "Struktuuriüksus"           
    ## [3] "Allstruktuuriüksus"         "Ametikoht"                 
    ## [5] "Eesnimi"                    "Perekonnanimi"             
    ## [7] "Ametniku koormus ametkohal" "Põhipalk"

    ## 01.04.2016

    ## [1] "Asutus"                     "Struktuuriüksus"           
    ## [3] "Allstruktuuriüksus"         "Ametikoht"                 
    ## [5] "Eesnimi"                    "Perekonnanimi"             
    ## [7] "Ametniku koormus ametkohal" "Põhipalk"

    ## 01.04.2017

    ## [1] "Asutus"                     "Struktuuriüksus"           
    ## [3] "Allstruktuuriüksus"         "Ametikoht"                 
    ## [5] "Eesnimi"                    "Perekonnanimi"             
    ## [7] "Ametniku koormus ametkohal" "Põhipalk"

    ## 01.04.2018

    ## [1] "Asutus"                     "Struktuuriüksus"           
    ## [3] "Ametikoht"                  "Eesnimi"                   
    ## [5] "Perekonnanimi"              "Ametniku koormus ametkohal"
    ## [7] "Põhipalk"

    ## 01.04.2019

    ## [1] "Asutus"                     "Struktuuriüksus"           
    ## [3] "Ametikoht"                  "Eesnimi"                   
    ## [5] "Perekonnanimi"              "Ametniku koormus ametkohal"
    ## [7] "Põhipalk"

Hakkab silma, et "Allstruktuuriüksus on olemas vaid esimeste aastate
andmestikes. Eemaldame selle.

``` r
wb.all = c()
for(i in fnFs){
wb = readWorkbook(i, colNames = TRUE, skipEmptyRows = TRUE)
colnames(wb) = wb[1,]
wb = wb[-1:-2,]
wb$kp = gsub("^.*?palk_|_riik.*$|.xlsx","", i)

wb = wb[,!grepl("Allstruktuuriüksus", colnames(wb))]  
wb.all = rbind(wb.all, wb)
}
data.all = wb.all
```

Kokku on koondatud 66587 andmepunkti (rida).
